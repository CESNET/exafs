{% extends 'layouts/default.j2' %}
{% from 'forms/macros.j2' import render_field, render_ip_and_mask_field_group, fill_org_form %}
{% block title %}Add IPv4 rule{% endblock %}
{% block content %}
    <h2>{{ title or 'New' }} IPv4 rule</h2>
    <form action="{{ action_url }}" method="POST">
        {{ form.hidden_tag() if form.hidden_tag }}
        <div class="row">
            <div class="col-sm-12 col-md-6">
                {{ render_ip_and_mask_field_group(form.source, form.source_mask, ipKwargs={'placeholder': '192.160.0.1'},
                 maskKwargs={'min':'0', 'max':'32', 'placeholder': '24'}) }}
            </div>
            <div class="col-sm-12 col-md-6">
                {{ render_ip_and_mask_field_group(form.dest, form.dest_mask, ipKwargs={'placeholder': '192.160.0.1'},
                 maskKwargs={'min':'0', 'max':'32', 'placeholder': '24'}) }}
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                {{ render_field(form.source_port, tooltip="Possible values: x;&gt;x;x-y;&lt;x;&lt;=x;&gt;=x") }}
            </div>
            <div class="col-sm-6">
                {{ render_field(form.dest_port, tooltip="Possible values: x;&gt;x;x-y;&lt;x;&lt;=x;&gt;=x") }}
            </div>
        </div>

        <div class="row">
            <div class="col-sm-4">
                {{ render_field(form.packet_len, tooltip="Possible values: x;&gt;x;x-y;&lt;x;&lt;=x;&gt;=x") }}
            </div>
            <div class="col-sm-2">
                 {{ render_field(form.fragment, size=4) }}
            </div>
            <div class="col-sm-2">
                {{ render_field(form.protocol, id='protocolSelect', onchange="ExaFS.hideFieldIfNot(this.value, 'tcp', 'tcpFlagContainer')" ) }}
            </div>
            <div class="col-sm-2" id="tcpFlagContainer">
                {{ render_field(form.flags, size=6) }}
            </div>
        </div>

        <hr class="my-4">

        <div class="row">
            <div class="col-sm-6">
                {{ render_field(form.action) }}
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <label for="inputExpiration" class="control-label">Expiration date</label>
                    <div class='input-group date' id='dateTimeExpires'>
                        {{ form.expires(class_='form-control') }}
                        <span class="input-group-addon">
                          <span class="glyphicon glyphicon-calendar"></span>
                      </span>
                    </div>

                    {% if form.expires.errors %}
                        {% for e in form.expires.errors %}
                            <p class="help-block">{{ e }}</p>
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-12">
                {{ render_field(form.comment) }}
            </div>
        </div>

        <div class="row">
            <div class="col-sm-10">
                <button type="submit" class="btn btn-primary">Save</button>
            </div>
        </div>
     <div class="d-none" id="ddos-protector-form-wrapper">
        </div>
    </form>
        {{ fill_org_form(form.net_ranges) }}
{% endblock %}